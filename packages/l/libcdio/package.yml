# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name: libcdio
version: 2.2.0
release: 10
source:
    - https://github.com/libcdio/libcdio/releases/download/2.2.0/libcdio-2.2.0.tar.bz2: 6f8fbdf4d189cf63f2a7a1549c516cd720c7b222c7aaadbc924a26e745a48539
homepage: https://www.gnu.org/software/libcdio/
license: GPL-3.0-or-later
component: multimedia.library
summary: A library to encapsulate CD-ROM reading and control
description: |
    This library provides an interface for CD-ROM access. It can be used by applications that need OS- and device-independent access to CD-ROM devices.
builddeps:
    - pkgconfig(libcddb)
setup: |
    %patch -p1 -i $pkgfiles/libcdio-0.83-linking.patch
    %reconfigure --disable-static --disable-rpath
build: |
    %make
install: |
    %make_install

    # remove the architecture information from version.h
    sed -i -e "s|${version//./\\.}.*$|${version}\\\"|g" $installdir/usr/include/cdio/version.h
    # remove the source build path from cdio_config.h
    sed -i "/LIBCDIO_SOURCE_PATH/s|.*|/* #undef LIBCDIO_SOURCE_PATH */|" $installdir/usr/include/cdio/cdio_config.h
check: |
    %make check
