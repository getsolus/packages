name       : libcd
version    : 5.14
release    : 1
source     :
    - https://sourceforge.net/projects/canvasdraw/files/5.14/Docs%20and%20Sources/cd-5.14_Sources.zip : 83a31e2133ec5cc606517d39e49709b8ac2cab72c29dd94aa2872c3763dbf46c
homepage   : https://www.tecgraf.puc-rio.br/cd/
license    : MIT
component  : multimedia.graphics
summary    : Canvas Draw - 2D vector graphics library
description: |
    CD (Canvas Draw) is a platform-independent graphics library. It is implemented in several platforms using native graphics libraries: Microsoft Windows (GDI) and X-Windows (XLIB). The library contains functions to support both vector and image applications, and the visualization surface can be either a window or a more abstract surface, such as Image, Clipboard, Metafile, PS, and so on.
builddeps  :
    - pkgconfig(fontconfig)
    - pkgconfig(ftgl)
    - pkgconfig(glu)
    - pkgconfig(gtk+-3.0)
    - pkgconfig(libim)
    - pkgconfig(libim-lua)
    - pkgconfig(lua)
    - pkgconfig(pdflib)
    - lsb-release
rundeps:
    - lua-devel:
        - libcd-lua
patterns   :
    - lua :
        - /usr/lib64/libcdlua*.so.*
    - lua-devel :
        - /usr/include/tecgraf/cd/cdlua*.h
        - /usr/lib64/libcdlua*.so
        - /usr/lib64/pkgconfig/*lua.pc
environment:
    export USE_PKGCONFIG=Yes
    export USE_LUA_VERSION=53
    export LIBLUA_SFX=
    export LUA_SFX=
    export LUA_INC=/usr/include
    export LUA_LIB=/usr/lib
    export LUA_BIN=/usr/bin/lua
    export IM_LIB=/usr/lib
    export IM_INC=/usr/include/tecgraf/im
setup      : |
    %patch -p 1 -i $pkgfiles/0001-Linux6-support.patch
    %patch -p 1 -i $pkgfiles/0002-fix-lua-sfx.patch
    %patch -p 1 -i $pkgfiles/0003-shared-links.patch
build      : |
    %make -j1
install    : |
    install -dm00755 $installdir/usr/{lib64/pkgconfig,include/tecgraf/cd}
    install -m00644 $pkgfiles/*.pc $installdir/usr/lib64/pkgconfig
    rm lib/Linux*/{*.a,Lua/*.a}
    chmod -R 00755 lib/Linux*/*
    mv lib/Linux*/*.* $installdir/usr/lib64/
    mv lib/Linux*/Lua/* $installdir/usr/lib64/
    install -m00644 include/* $installdir/usr/include/tecgraf/cd/
