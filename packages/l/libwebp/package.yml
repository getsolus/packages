# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : libwebp
version    : 1.6.0
release    : 29
source     :
    - https://github.com/webmproject/libwebp/archive/refs/tags/v1.6.0.tar.gz : 93a852c2b3efafee3723efd4636de855b46f9fe1efddd607e1f42f60fc8f2136
homepage   : https://developers.google.com/speed/webp/
license    : BSD-3-Clause
component  : multimedia.codecs
emul32     : true
summary    : A new image format for the web
description: |
    WebP is a new image format that provides lossless and lossy compression for images on the web. WebP lossless images are 26% smaller in size compared to PNGs. WebP lossy images are 25-34% smaller in size compared to JPEG images at equivalent SSIM index. WebP supports lossless transparency (also known as alpha channel) with just 22% additional bytes. Transparency is also supported with lossy compression and typically provides 3x smaller file sizes compared to PNG when lossy compression is acceptable for the red/green/blue color channels.
avx2       : true
optimize   :
    - lto
    - speed
patterns   :
    - devel : /usr/share/man
builddeps  :
    - pkgconfig32(glu)
    - pkgconfig32(glut)
    - pkgconfig32(libpng)
    - pkgconfig32(libtiff-4)
    - pkgconfig32(libturbojpeg)
    - pkgconfig32(zlib)
    - giflib-devel
setup      : |
    %reconfigure --disable-static --enable-everything
build      : |
    %make
install    : |
    %make_install

    # Clear out uneeded x86-64-v3 files
    if [[ ! -z "${AVX2BUILD}" ]]; then
        for nuke in `ls $installdir/%libdir% | grep -v -E "libwebp.so"`; do
            rm -rfv $installdir/%libdir%/${nuke}
        done
    fi
