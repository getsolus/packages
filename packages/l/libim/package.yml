name       : libim
version    : 3.15
release    : 1
source     :
    - https://sourceforge.net/projects/imtoolkit/files/3.15/Docs%20and%20Sources/im-3.15_Sources.zip : 06b0eab536b6a3c310982cd8fd6e941bc6acdea47798616c334053ab3e1d659c
homepage   : https://imtoolkit.sourceforge.net/
license    : MIT
component  : multimedia.library
summary    : IM is a toolkit for Digital Imaging
description: |
    IM is based on 4 concepts: Image Representation, Storage, Processing and Capture. The main goal of the library is to provide a simple API and abstraction of images for scientific applications.
    The most popular file formats are supported: TIFF, BMP, PNG, JPEG, GIF and AVI. Image representation includes scientific data types, and about a hundred Image Processing operations are available.
builddeps  :
    - pkgconfig(fftw3)
    - pkgconfig(libpng)
    - pkgconfig(lua)
    - lsb-release
rundeps:
    - lua-devel:
        - libim-lua
patterns   :
    - lua :
        - /usr/lib64/libimlua*.so.*
    - lua-devel :
        - /usr/include/tecgraf/im/imlua*.h
        - /usr/lib64/libimlua*.so
        - /usr/lib64/pkgconfig/*lua.pc
environment:
    export USE_PKGCONFIG=Yes
    export USE_LUA_VERSION=53
    export LIBLUA_SFX=
    export LUA_SFX=
    export LUA_INC=/usr/include
    export LUA_LIB=/usr/lib
    export LUA_BIN=/usr/bin/lua
setup      : |
    %patch -p 1 -i $pkgfiles/0001-fix-lua-sfx.patch
    %patch -p 1 -i $pkgfiles/0002-shared-links.patch
build      : |
    %make -j1
install    : |
    install -dm00755 $installdir/usr/{lib64/pkgconfig,include/tecgraf/im}
    install -m00644 $pkgfiles/*.pc $installdir/usr/lib64/pkgconfig
    rm lib/Linux*/{*.a,Lua/*.a}
    chmod -R 00755 lib/Linux*/*
    mv lib/Linux*/*.* $installdir/usr/lib64/
    mv lib/Linux*/Lua/* $installdir/usr/lib64/
    install -m00644 include/* $installdir/usr/include/tecgraf/im/
