# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : libpng
version    : 1.6.53
release    : 32
source     :
    - https://sourceforge.net/projects/libpng/files/libpng16/1.6.53/libpng-1.6.53.tar.gz : da0b045cbb1d06a8fc9696f9441359f70645f280ff24ae453ccb7c722353654f
homepage   : https://www.libpng.org/pub/png/
license    : Libpng
component  : multimedia.library
summary    : libpng (Official PNG reference library)
description: |
    libpng is the official PNG reference library, supporting almost all PNG features and has been extensively tested.
emul32     : true
avx2       : true
builddeps  :
    - pkgconfig32(zlib)
setup      : |
    # Fails due to zlib-ng compression stream changes
    %patch -p1 -i $pkgfiles/0001-skip-pngtest-all.patch

    %configure --disable-static --enable-intel-sse
build      : |
    %make
install    : |
    %make_install
    rm -v $installdir/%libdir%/*.la
    %install_license LICENSE
check      : |
    %make check || ( cat ./test-suite.log && exit 1 )
patterns   :
    - devel :
        - /usr/bin/libpng*-config
