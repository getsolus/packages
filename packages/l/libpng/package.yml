# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : libpng
version    : 1.6.55
release    : 34
source     :
    - https://sourceforge.net/projects/libpng/files/libpng16/1.6.55/libpng-1.6.55.tar.gz : 4b0abab6d219e95690ebe4db7fc9aa95f4006c83baaa022373c0c8442271283d
homepage   : https://www.libpng.org/pub/png/
license    : Libpng
component  : multimedia.library
summary    : libpng (Official PNG reference library)
description: |
    libpng is the official PNG reference library, supporting almost all PNG features and has been extensively tested.
emul32     : true
avx2       : true
builddeps  :
    - pkgconfig32(zlib)
setup      : |
    # Fails due to zlib-ng compression stream changes
    %patch -p1 -i $pkgfiles/0001-skip-pngtest-all.patch

    %configure --disable-static --enable-intel-sse
build      : |
    %make
install    : |
    %make_install
    rm -v $installdir/%libdir%/*.la
    %install_license LICENSE
check      : |
    %make check || ( cat ./test-suite.log && exit 1 )
patterns   :
    - devel :
        - /usr/bin/libpng*-config
