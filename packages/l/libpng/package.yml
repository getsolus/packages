# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : libpng
version    : 1.6.51
release    : 30
source     :
    - https://sourceforge.net/projects/libpng/files/libpng16/1.6.51/libpng-1.6.51.tar.gz : ac25cafc2054cda3f6f0fe22ee9fc587024b99e01d03bd72b765824e48f39021
homepage   : https://www.libpng.org/pub/png/
license    : Libpng
component  : multimedia.library
summary    : libpng (Official PNG reference library)
description: |
    libpng is the official PNG reference library, supporting almost all PNG features and has been extensively tested.
emul32     : true
avx2       : true
builddeps  :
    - pkgconfig32(zlib)
setup      : |
    # Fails due to zlib-ng compression stream changes
    %patch -p1 -i $pkgfiles/0001-skip-pngtest-all.patch

    %configure --disable-static --enable-intel-sse
build      : |
    %make
install    : |
    %make_install
    rm -v $installdir/%libdir%/*.la
check      : |
    %make check || ( cat ./test-suite.log && exit 1 )
patterns   :
    - devel :
        - /usr/bin/libpng*-config
