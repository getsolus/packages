# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name: libpng
version: 1.6.52
release: 31
source:
    - https://sourceforge.net/projects/libpng/files/libpng16/1.6.52/libpng-1.6.52.tar.gz: 86d4a88be1c8bc903674199f1d067a9ac940af4e4399caba0314e7a1bcaa0724
homepage: https://www.libpng.org/pub/png/
license: Libpng
component: multimedia.library
summary: libpng (Official PNG reference library)
description: |
    libpng is the official PNG reference library, supporting almost all PNG features and has been extensively tested.
emul32: true
avx2: true
builddeps:
    - pkgconfig32(zlib)
setup: |
    # Fails due to zlib-ng compression stream changes
    %patch -p1 -i $pkgfiles/0001-skip-pngtest-all.patch

    %configure --disable-static --enable-intel-sse
build: |
    %make
install: |
    %make_install
    rm -v $installdir/%libdir%/*.la
check: |
    %make check || ( cat ./test-suite.log && exit 1 )
patterns:
    - devel:
          - /usr/bin/libpng*-config
