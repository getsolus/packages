# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : freetype2
version    : 2.14.1
release    : 38
source     :
    - https://download.savannah.gnu.org/releases/freetype/freetype-2.14.1.tar.xz : 32427e8c471ac095853212a37aef816c60b42052d4d9e48230bab3bdf2936ccc
homepage   : https://freetype.org/
license    :
    - FTL
    - GPL-2.0-only
component  :
    - desktop.library
summary    : Font rendering library
description: |
    The FreeType2 package contains a library which allows applications to properly render TrueType fonts.
patterns   :
    - devel :
        - /usr/bin/freetype-config
        - /usr/share/man/man1
        - /usr/share/aclocal
builddeps  :
    - pkgconfig32(bzip2)
    - pkgconfig32(freetype2)
    - pkgconfig32(libbrotlicommon)
emul32     : true
optimize   : speed
setup      : |
    %patch -p1 -i ${pkgfiles}/long-names.patch
    %patch -p1 -i ${pkgfiles}/0001-modules-Enable-gxvalid-otvalid.patch
    %patch -p1 -i ${pkgfiles}/0002-config-Enable-subpixel-rendering-infinality-engine.patch

    sed 's/%PKG_CONFIG%/pkg-config/g' builds/unix/freetype-config.in > freetype-config
    %meson_configure -Dharfbuzz="dynamic"
build      : |
    %ninja_build
install    : |
    %ninja_install
    %install_license LICENSE.TXT

    install -Dm00644 builds/unix/freetype2.m4 $installdir/usr/share/aclocal/freetype2.m4
    install -Dm00755 freetype-config $installdir/usr/bin/freetype-config
    install -Dm00644 docs/freetype-config.1 $installdir/usr/share/man/man1/freetype-config.1
