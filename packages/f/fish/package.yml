# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : fish
version    : 4.4.0
release    : 44
homepage   : https://fishshell.com
source     :
    - https://github.com/fish-shell/fish-shell/releases/download/4.4.0/fish-4.4.0.tar.xz : 529e1072c034f6c9d21a922c359886df75129c3d81a15bd8656a3c4860993ad5
license    :
    # Files have different licenses
    # Licenses like MIT, BSD etc. are related to deps, not fish itself
    - GPL-2.0-only
    - GPL-2.0-or-later
    - GPL-3.0-or-later
component  : system.utils
summary    : A full-blown user-friendly command line shell
description: |
    Fish is a smart and user-friendly command line shell for macOS, Linux, and the rest of the family. Fish includes features like syntax highlighting, autosuggest-as-you-type, and fancy tab completions that just work, with no configuration required.
builddeps  :
    - pkgconfig(libpcre2-posix)
    - python-sphinx
    - rust
networking : true
clang      : true
setup      : |
    %cargo_fetch
    %cmake_ninja
build      : |
    %ninja_build
install    : |
    %ninja_install
    rm -rfv $installdir/usr/share/doc/fish/{_sources,.buildinfo}

    # Stateless
    rm -rfv $installdir/usr/etc/
    install -Dm00644 $pkgfiles/fish.tmpfiles $installdir/%libdir%/tmpfiles.d/fish.conf
check      : |
    # Both of these have tests that fail since we're running the tests as root
    rm -v tests/checks/{cd,path}.fish

    %cargo_test -- --skip test_redirections
    %install_license COPYING
