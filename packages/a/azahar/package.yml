name       : azahar
version    : '2112.1'
release    : 1
source     :
    - https://github.com/azahar-emu/azahar/releases/download/2122.1/azahar-unified-source-2122.1.tar.xz : bd2bba24511af6307abd86d1f9a9af326658dcbffca04133e0bbe304671d20aa
homepage   : https://azahar-emu.org/
license    : GPL-2.0-or-later
component  : games.emulator
summary    : An open-source 3DS emulator project based on Citra
description: |
    Azahar is an open-source 3DS emulator project based on Citra. It was created from the merging of PabloMK7's Citra fork and the Lime3DS project, both of which emerged shortly after Citra was taken down.
builddeps  :
    - pkgconfig(Qt6Multimedia)
    - pkgconfig(RapidJSON)
    - pkgconfig(SPIRV-Headers)
    - pkgconfig(catch2)
    - pkgconfig(fmt)
    - pkgconfig(inih)
    - pkgconfig(jack)
    - pkgconfig(libavcodec-4.4)
    - pkgconfig(libcryptopp)
    - pkgconfig(libenet)
    - pkgconfig(libpipewire-0.3)
    - pkgconfig(libssl)
    - pkgconfig(libusb-1.0)
    - pkgconfig(nlohmann_json)
    - pkgconfig(portaudio-2.0)
    - pkgconfig(sdl2)
    - pkgconfig(sndio)
    - pkgconfig(soundtouch)
    - pkgconfig(x11)
    - pkgconfig(xext)
    - glslang-devel
    - libboost-devel
    - qt6-base-private-devel
    - robin-map
    - vulkan-headers
clang      : yes
optimize   :
    - speed
    - thin-lto
setup      : |
    %cmake_ninja \
        -DENABLE_QT_UPDATER=OFF \
        -DUSE_DISCORD_PRESENCE=ON \
        -DUSE_SYSTEM_BOOST=ON \
        -DUSE_SYSTEM_CATCH2=ON \
        -DUSE_SYSTEM_CRYPTOPP=ON \
        -DUSE_SYSTEM_FFMPEG_HEADERS=ON \
        -DUSE_SYSTEM_FMT=ON \
        -DUSE_SYSTEM_ENET=ON \
        -DUSE_SYSTEM_GLSLANG=ON \
        -DUSE_SYSTEM_INIH=ON \
        -DUSE_SYSTEM_JSON=ON \
        -DUSE_SYSTEM_LIBUSB=ON \
        -DUSE_SYSTEM_QT=ON \
        -DUSE_SYSTEM_SDL2=ON \
        -DUSE_SYSTEM_SOUNDTOUCH=ON \
        -DUSE_SYSTEM_VULKAN_HEADERS=ON \
        -DSIRIT_USE_SYSTEM_SPIRV_HEADERS=ON
build      : |
    %ninja_build
install    : |
    %ninja_install
    install -Dm00644 $pkgfiles/org.azahar_emu.Azahar.metainfo.xml -t $installdir/usr/share/metainfo
replaces   :
    - citra
    - lime3ds
    - dbginfo :
        - citra-dbginfo
        - lime3ds-dbginfo
