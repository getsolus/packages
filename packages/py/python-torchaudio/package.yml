# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : python-torchaudio
version    : 2.9.1
release    : 10
source     :
    - https://github.com/pytorch/audio/archive/refs/tags/v2.9.1.tar.gz : 590492c90552959b3df6f601eb733135064bf2d9e53c516adcf6845a4e545662
homepage   : https://pytorch.org/audio
license    : BSD-3-Clause
component  : programming.python
summary    : Datasets, Transforms and Models specific to Computer Vision
description: |
    The torchaudio package consists of popular datasets, model architectures, and common image transformations for computer audio.
# clang      : true
networking : true
builddeps  :
    - pkgconfig(libavformat)
    - pkgconfig(libdrm)
    - pkgconfig(libjpeg)
    - pkgconfig(libpng)
    - pkgconfig(protobuf)
    - pkgconfig(python3)
    - pkgconfig(tbb)
    - libtorch-devel
    - python-build
    - python-installer
    - python-setuptools
    - pytorch
    - rocm-hip
rundeps    :
    - numpy
    - python-pillow
    - python-six
    - python-tqdm
    - pytorch
environment: |
    export MAX_JOBS=%YJOBS%

    export USE_ROCM=1 \
      USE_OPENMP=1

    export ROCM_PATH=/usr
    export HIP_PATH=/usr
    export HIP_CLANG_PATH=/usr/lib64/llvm-rocm/bin
    export HIP_CXX_COMPILER=/usr/bin/hipcc
    export HIP_DEVICE_LIB_PATH="/usr/lib64/amdgcn/bitcode"
    export PYTORCH_ROCM_ARCH="%AMDGPUTARGETS%"
setup      : |
    echo "%version%" > version.txt
build      : |
    %python3_setup
install    : |
    %python3_install
