From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Evan Maddock <maddock.evan@vivaldi.net>
Date: Sat, 1 Nov 2025 19:19:00 -0400
Subject: [PATCH] libpeas libgirepository2

Signed-off-by: Evan Maddock <maddock.evan@vivaldi.net>
---
 src/main.c                  | 4 ++--
 src/xviewer-plugin-engine.c | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/src/main.c b/src/main.c
index eaf7fcb..db46cd6 100644
--- a/src/main.c
+++ b/src/main.c
@@ -27,7 +27,7 @@
 #include "config.h"
 #endif
 #ifdef HAVE_INTROSPECTION
-#include <girepository.h>
+#include <girepository/girepository.h>
 #endif
 
 #include "xviewer-application.h"
@@ -102,7 +102,7 @@ main (int argc, char **argv)
 	 * Using gtk_get_option_group here initializes gtk during parsing */
 	g_option_context_add_group (ctx, gtk_get_option_group (FALSE));
 #ifdef HAVE_INTROSPECTION
-	g_option_context_add_group (ctx, g_irepository_get_option_group ());
+	g_option_context_add_group (ctx, gi_repository_get_option_group ());
 #endif
 
 	if (!g_option_context_parse (ctx, &argc, &argv, &error)) {
diff --git a/src/xviewer-plugin-engine.c b/src/xviewer-plugin-engine.c
index 8feb747..2d69e5e 100644
--- a/src/xviewer-plugin-engine.c
+++ b/src/xviewer-plugin-engine.c
@@ -34,7 +34,7 @@
 #include <glib/gi18n.h>
 #include <glib.h>
 #include <gio/gio.h>
-#include <girepository.h>
+#include <girepository/girepository.h>
 
 #define XVIEWER_PLUGIN_DATA_DIR XVIEWER_DATA_DIR G_DIR_SEPARATOR_S "plugins"
 
@@ -86,7 +86,7 @@ xviewer_plugin_engine_new (void)
 	GError *error = NULL;
 
 	/* This should be moved to libpeas */
-	if (g_irepository_require (g_irepository_get_default (),
+	if (gi_repository_require (gi_repository_dup_default (),
 				   "Peas", "1.0", 0, &error) == NULL)
 	{
 		g_warning ("Error loading Peas typelib: %s\n",
@@ -95,7 +95,7 @@ xviewer_plugin_engine_new (void)
 	}
 
 
-	if (g_irepository_require (g_irepository_get_default (),
+	if (gi_repository_require (gi_repository_dup_default (),
 				   "PeasGtk", "1.0", 0, &error) == NULL)
 	{
 		g_warning ("Error loading PeasGtk typelib: %s\n",
@@ -105,7 +105,7 @@ xviewer_plugin_engine_new (void)
 
 	typelib_path = g_build_filename (LIBDIR, "xviewer", "girepository-1.0", NULL);
 
-	if (g_irepository_require_private (g_irepository_get_default (), typelib_path,
+	if (gi_repository_require_private (gi_repository_dup_default (), typelib_path,
 					   "Xviewer", "3.0", 0, &error) == NULL)
 	{
 		g_warning ("Error loading Xviewer typelib: %s\n",
