name       : VTK
version    : 8.2.0
release    : 13
source     :
    - https://www.vtk.org/files/release/8.2/VTK-8.2.0.tar.gz : 34c3dc775261be5e45a8049155f7228b6bd668106c72a3c435d95730d17d57bb
license    : BSD-3-Clause
component  : programming.library
summary    : Visualization toolkit
description: |
    The Visualization Toolkit (VTK) is an open-source, freely available software system for 3D computer graphics, image processing, and visualization. It consists of a C++ class library and several interpreted interface layers including Tcl/Tk, Java, and Python.
builddeps  :
    - pkgconfig(freetype2)
    - pkgconfig(glew)
    - pkgconfig(hdf5-1.10.4)
    - pkgconfig(jsoncpp)
    - pkgconfig(liblz4)
    - pkgconfig(libtiff-4)
    - pkgconfig(libturbojpeg)
    - pkgconfig(proj)
    - pkgconfig(python3)
    - pkgconfig(sm)
    - pkgconfig(theora)
    - pkgconfig(xt)
#enviornment: |
#    export CFLAGS="${CFLAGS} -fcommon"
#    export CXXFLAGS="${CXXFLAGS} -fcommon"
setup      : |
    %apply_patches
    
    patch -d ThirdParty/exodusII/vtkexodusII -p1 -i $pkgfiles/gcc10.patch
    sed -e 's|REGEX MATCH \"\[3-9\]|REGEX MATCH \"[1-9][0-9]|' -i CMake/VTKGenerateExportHeader.cmake

    %cmake_ninja -DCMAKE_BUILD_TYPE=Release \
        -DVTK_INSTALL_LIBRARY_DIR=%libdir%/vtk \
        -DVTK_INSTALL_PACKAGE_DIR=%libdir%/cmake/vtk \
        -DVTK_INSTALL_INCLUDE_DIR=include/vtk \
        -DVTK_PYTHON_VERSION=3 \
        -DVTK_WRAP_PYTHON=ON \
        -DVTK_USE_SYSTEM_EXPAT=ON \
        -DVTK_USE_SYSTEM_FREETYPE=ON \
        -DVTK_USE_SYSTEM_GLEW=ON \
        -DVTK_USE_SYSTEM_HDF5=ON \
        -DVTK_USE_SYSTEM_JSONCPP=ON \
        -DVTK_USE_SYSTEM_JPEG=ON \
        -DVTK_USE_SYSTEM_LIBPROJ=ON \
        -DVTK_USE_SYSTEM_LIBXML2=ON \
        -DVTK_USE_SYSTEM_LZ4=ON \
        -DVTK_USE_SYSTEM_THEORA=ON \
        -DVTK_USE_SYSTEM_OGG=ON \
        -DVTK_USE_SYSTEM_PNG=ON \
        -DVTK_USE_SYSTEM_TIFF=ON \
        -DVTK_USE_SYSTEM_ZLIB=ON
build      : |
    %ninja_build
install    : |
    %ninja_install
