# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : chiaki-ng
version    : 1.9.9
release    : 3
source     :
    - git|https://github.com/streetpea/chiaki-ng.git : v1.9.9
homepage   : https://streetpea.github.io/chiaki-ng/
license    : AGPL-3.0-only
component  : games
summary    : Free and Open Source PS4/PS5 Remote Play Client
description: |
    Chiaki is a Free and Open Source Software Client for PlayStation 4/5 Remote Play for Linux, macOS, Windows and potentially even more platforms.
builddeps  :
    - pkgconfig(Qt6Gui)
    - pkgconfig(Qt6Qml)
    - pkgconfig(Qt6Svg)
    - pkgconfig(Qt6WebEngineQuick)
    - pkgconfig(fftw3)
    - pkgconfig(hidapi-libusb)
    - pkgconfig(json-c)
    - pkgconfig(libavcodec)
    - pkgconfig(libcurl)
    - pkgconfig(libopusenc)
    - pkgconfig(libplacebo)
    - pkgconfig(miniupnpc)
    - pkgconfig(protobuf)
    - pkgconfig(sdl2)
    - pkgconfig(speexdsp)
    - python-protobuf
    - qt6-base-private-devel
environment: |
    export CFLAGS+=" -std=gnu17"
setup      : |
    %patch -p1 -i ${pkgfiles}/qt-6.10.0.patch
    %patch -p1 -i ${pkgfiles}/0001-Fix-Wayland-appId.patch
    %patch -p1 -d third-party/cpp-steam-tools -i ${pkgfiles}/0001-Build-cpp-steam-tools-static.patch

    %cmake_ninja -DCHIAKI_USE_SYSTEM_CURL=ON
build      : |
    %ninja_build
install    : |
    %ninja_install
    %install_license COPYING LICENSES/*

    # Useless to us
    rm -rfv ${installdir}/usr/include \
            ${installdir}/usr/lib
replaces   :
    - chiaki
    - dbginfo : chiaki-dbginfo
