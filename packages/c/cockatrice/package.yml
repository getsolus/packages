# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : cockatrice
version    : 2.10.2
release    : 26
source     :
    - https://github.com/Cockatrice/Cockatrice/archive/refs/tags/2025-04-03-Release-2.10.2.tar.gz : 73cabec34604261b3ec2beb66b6a11faff0b0d1ca50f25cc58a45325a39225d4
homepage   : https://cockatrice.github.io/
license    : GPL-2.0-or-later
summary    : A cross-platform virtual tabletop for multiplayer card games
component  : games.card
description: |
    Cockatrice is an open-source multiplatform software for playing card games, such as Magic: The Gathering, over a network. It is fully client-server based to prevent any kind of cheating, though it supports single-player games without a network interface as well
builddeps  :
    - pkgconfig(Qt6Linguist)
    - pkgconfig(Qt6Multimedia)
    - pkgconfig(Qt6Svg)
    - pkgconfig(Qt6WebSockets)
    - pkgconfig(liblzma)
    - pkgconfig(protobuf)
rundeps    :
    - wget
clang      : true
optimize   : thin-lto
setup      : |
    %patch -p1 -i $pkgfiles/0001-Update-Wayland-appId-to-match-desktop-rename.patch
    %cmake_ninja -DWITH_SERVER=1
build      : |
    %ninja_build
install    : |
    %ninja_install
    %install_license LICENSE

    # Install metadata 
    install -Dm00644 $pkgfiles/io.github.Cockatrice.cockatrice.metainfo.xml $installdir/usr/share/metainfo/io.github.Cockatrice.cockatrice.metainfo.xml
    # rename desktop file to match appstream desktop-id
    mv $installdir/usr/share/applications/{cockatrice,io.github.Cockatrice.cockatrice}.desktop
