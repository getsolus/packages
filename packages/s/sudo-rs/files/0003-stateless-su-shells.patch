--- a/src/su/context.rs
+++ b/src/su/context.rs
@@ -40,7 +40,10 @@ pub(crate) struct SuContext {
 /// check that a shell is not restricted / exists in /etc/shells
 fn is_restricted(shell: &Path) -> bool {
     if let Some(pattern) = shell.as_os_str().to_str() {
-        if let Ok(contents) = fs::read_to_string(VALID_LOGIN_SHELLS_LIST) {
+        // Solus stateless: check /etc/shells first, then vendor default
+        let contents = fs::read_to_string(VALID_LOGIN_SHELLS_LIST)
+            .or_else(|_| fs::read_to_string("/usr/share/defaults/etc/shells"));
+        if let Ok(contents) = contents {
             return !contents.lines().any(|l| l == pattern);
         } else {
             return FALLBACK_LOGIN_SHELL != pattern;
