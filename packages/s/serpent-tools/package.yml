name       : serpent-tools
version    : 0.0.1
release    : 1
source     :
    - https://github.com/serpent-os/tools/archive/476cf0e9626805b6bd0fd4f110e113fc9c6092b6.tar.gz : 7c63bfce8cff30561f19b4228476e594927bbff6dd89eb028c9ef3a23ae1ba09
license    :
    - MPL-2.0
homepage   : https://github.com/serpent-os/tools
component  :
    - programming.library # temporary
    - ^libstone : system.base
    - ^libstone-devel : system.devel
summary    :
    - Tooling from the Serpent OS project
    - ^libstone : Library for reading .stone archives
    - ^libstone-devel : Library for reading .stone archives
description:
    - Tooling from the Serpent OS project
    - ^libstone : Library for reading .stone archives
    - ^libstone-devel : Library for reading .stone archives
networking : yes
builddeps  :
    - cargo-c
environment: |
    # Force use of system libs
    export ZSTD_SYS_USE_PKG_CONFIG=1
setup      : |
    %cargo_fetch
build      : |
    cargo cbuild \
                 -p libstone \
                 --prefix=/usr \
                 --frozen \
                 --release
install    : |
    cargo cinstall \
                   -p libstone \
                   --destdir=$installdir \
                   --libdir=%libdir% \
                   --library-type=cdylib \
                   --release \
                   --frozen \
                   --prefix=/usr

    install -Dm00644 $pkgfiles/x-stone-archive.xml $installdir/usr/share/mime/packages/x-stone-archive.xml
patterns   :
    - ^libstone :
        - /usr/lib64/libstone.so.*
        - /usr/share/mime/
    - ^libstone-devel :
        - /usr/include/
        - /usr/lib64/libstone.so
        - /usr/lib64/pkgconfig/
