# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : scx-scheds
version    : 1.0.20
release    : 3
source     :
    - https://github.com/sched-ext/scx/archive/refs/tags/v1.0.20.tar.gz : d9c6b3230915dafe21556da28c6ef2a11f272770f12912842ae1ad23b54d963e
homepage   : https://github.com/sched-ext/scx
license    : MIT
component  : system.utils
summary    : sched_ext schedulers and tools
description: |
    sched_ext schedulers and tools
clang      : true
networking : true
builddeps  :
    - pkgconfig(libbpf)
    - pkgconfig(libseccomp)
    - pkgconfig(protobuf)
    - rust-devel
rundeps    :
    - scx-tools
environment: |
    # sscache is broken for this build. Disable it for now.
    unset RUSTC_WRAPPER
setup      : |
    %cargo_fetch
build      : |
    %cargo_build
install    : |
    find target/release \
        -maxdepth 1 -type f -executable ! -name '*.so' \
        -exec install -Dm00755 -t "$installdir/usr/bin/" {} +

    # Useless stuff not needed
    rm -v $installdir/usr/bin/{scx_arena_selftests,vmlinux_docify,xtask}
