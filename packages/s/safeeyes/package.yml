# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : safeeyes
version    : 3.3.1
release    : 21
source     :
    - https://github.com/slgobinath/SafeEyes/archive/refs/tags/v3.3.1.tar.gz : 61d91b4ac5fc583275e534cb7a475e4af5f16be19300ec5f31c3eae868d76c1b
homepage   : https://slgobinath.github.io/safeeyes/
license    : GPL-3.0-or-later
component  : desktop
summary    : Safe Eyes is a tool to reduce and prevent repetitive strain injury (RSI)
description: |
    Protect your eyes from eye strain using this simple and beautiful, yet extensible break reminder.
builddeps  :
    - python-build
    - python-installer
    - python-setuptools
rundeps    :
    - libgtk-4
    - libnotify
    - pipewire
    - python-babel
    - python-croniter
    - python-gobject
    - python-psutil
    - python-pywayland
    - python-xlib
    - xprintidle
build      : |
    %python3_setup
install    : |
    %python3_install

    install -Dm00644 safeeyes/platform/io.github.slgobinath.SafeEyes.desktop -t ${installdir}/usr/share/applications

    install -Dm00644 safeeyes/platform/io.github.slgobinath.SafeEyes.metainfo.xml -t ${installdir}/usr/share/metainfo

    # Install icons
    for size in 16x16 24x24 32x32 48x48 64x64 128x128; do
        if [ -d safeeyes/platform/icons/hicolor/${size}/status ]; then
            install -Dm00644 safeeyes/platform/icons/hicolor/${size}/status/*.png -t ${installdir}/usr/share/icons/hicolor/${size}/status
        fi

        install -Dm00644 safeeyes/platform/icons/hicolor/${size}/apps/*.png -t ${installdir}/usr/share/icons/hicolor/${size}/apps
    done

    # Remove duplicate icons and desktop file.
    rm -rv $installdir/usr/lib/python%python3_version%/site-packages/safeeyes/platform
