name       : jujutsu
version    : 0.38.0
release    : 2
source     :
    - https://github.com/jj-vcs/jj/archive/refs/tags/v0.38.0.tar.gz : f28e280c01abb11aa9ff5ae7a35df3e9822fd37a013b6c1d79d1453a5f21f5ad
homepage   : https://jj-vcs.dev
license    : Apache-2.0
component  : programming.tools
summary    : jj is a Git-compatible version control system that is both simple and powerful.
description: |
    Jujutsu is a powerful version control system for software projects. You use it to get a copy of your code, track changes to the code, and finally publish those changes for others to see and use. It is designed from the ground up to be easy to useâ€”whether you're new or experienced, working on brand new projects alone, or large scale software projects with large histories and teams.
networking : true
builddeps  :
    - rust
checkdeps  :
    - git
    - openssh
environment: |
    export jj=target/release/jj
setup      : |
    %cargo_fetch
build      : |
    %cargo_build --all-features --package jj-cli

    # TODO(GZGavinZhao): make everything use dynamic completion by default for
    # best OOTB experience. Right now only fish shell can pick up dynamic
    # completion automatically so no setup is needed.
    mkdir completions
    $jj util completion bash > completions/jj
    $jj util completion zsh > completions/_jj
install    : |
    install -Dm00755 target/release/jj -t $installdir/usr/bin
    %install_license LICENSE

    install -Dm00644 completions/jj -t $installdir/usr/share/bash-completion/completions
    install -Dm00644 completions/_jj -t $installdir/usr/share/zsh/site-functions

    mkdir -p $installdir/usr/share/man
    $jj util install-man-pages $installdir/usr/share/man
check      : |
    # I don't know why this test fails... (fake)root weirdness?
    # https://github.com/jj-vcs/jj/blob/11c3dbe17ac0a2172755789613fa8f04a50118a0/lib/tests/test_local_working_copy.rs#L1834
    %cargo_test -- --skip test_check_out_existing_file_cannot_be_removed
