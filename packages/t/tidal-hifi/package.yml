# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : tidal-hifi
version    : 6.1.0
release    : 1
source     :
    - https://github.com/Mastermindzh/tidal-hifi/archive/refs/tags/6.1.0.tar.gz : 21eaf5d3d15f2af43f024ee24467c60b761585eb7c5c002d7c43634f494247dc
homepage   : https://github.com/Mastermindzh/tidal-hifi
license    : MIT
component  : multimedia.audio
summary    : Tidal in Electron with HiFi support via Widevine
description: |
    The web version of Tidal running in Electron with HiFi support thanks to Widevine.
    A desktop client for Tidal streaming music service with high-fidelity audio support.
networking : true
builddeps  :
    - pkgconfig(alsa)
    - pkgconfig(gtk+-3.0)
    - pkgconfig(xscrnsaver)
    - nodejs-22
environment: |
    export PATH="/usr/lib64/nodejs-22/bin:$PATH"
setup      : |
    npm install
build      : |
    npm run build-unpacked
install    : |
    %install_license LICENSE

    install -dm00755 $installdir/usr/share/tidal-hifi
    cp -a dist/linux-unpacked/. $installdir/usr/share/tidal-hifi/
    chmod +x $installdir/usr/share/tidal-hifi/tidal-hifi

    install -dm00755 $installdir/usr/bin
    ln -sv /usr/share/tidal-hifi/tidal-hifi $installdir/usr/bin/tidal-hifi

    install -Dm00644 assets/icon.png $installdir/usr/share/icons/hicolor/512x512/apps/tidal-hifi.png
    install -Dm00644 $pkgfiles/tidal-hifi.desktop $installdir/usr/share/applications/tidal-hifi.desktop

    # AppStream metainfo for software center
    install -Dm00644 $pkgfiles/com.mastermindzh.tidal-hifi.metainfo.xml $installdir/usr/share/metainfo/com.mastermindzh.tidal-hifi.metainfo.xml
