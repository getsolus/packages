From 02d45ac781c22b98310047777f9752056069916e Mon Sep 17 00:00:00 2001
From: Gavin Zhao <git@gzgz.dev>
Date: Mon, 13 Oct 2025 21:12:22 -0400
Subject: [PATCH] [device-libs] use FHS compliant install

---
 amd/device-libs/cmake/OCL.cmake      | 3 ++-
 amd/device-libs/cmake/Packages.cmake | 2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/amd/device-libs/cmake/OCL.cmake b/amd/device-libs/cmake/OCL.cmake
index 4f16d8cd81d7..7ea8dd8447a3 100644
--- a/amd/device-libs/cmake/OCL.cmake
+++ b/amd/device-libs/cmake/OCL.cmake
@@ -10,6 +10,7 @@
 # configure_file and we are included from multiple places. To get around this
 # we `file(WRITE)` a file with an @variable reference and `configure_file` it.
 cmake_policy(SET CMP0053 OLD)
+include(GNUInstallDirs)
 
 if(${CMAKE_VERSION} VERSION_GREATER_EQUAL "3.20.0")
   # The policy change was for handling of relative paths for
@@ -46,7 +47,7 @@ set (BC_EXT .bc)
 set (LIB_SUFFIX ".lib${BC_EXT}")
 set (STRIP_SUFFIX ".strip${BC_EXT}")
 set (FINAL_SUFFIX "${BC_EXT}")
-set (INSTALL_ROOT_SUFFIX "amdgcn/bitcode")
+set (INSTALL_ROOT_SUFFIX "${CMAKE_INSTALL_LIBDIR}/amdgcn/bitcode")
 
 if (NOT ROCM_DEVICE_LIBS_BITCODE_INSTALL_LOC_NEW STREQUAL "")
   set(INSTALL_ROOT_SUFFIX "${ROCM_DEVICE_LIBS_BITCODE_INSTALL_LOC_NEW}/bitcode")
diff --git a/amd/device-libs/cmake/Packages.cmake b/amd/device-libs/cmake/Packages.cmake
index 07c60eb39a22..f1283658b19a 100644
--- a/amd/device-libs/cmake/Packages.cmake
+++ b/amd/device-libs/cmake/Packages.cmake
@@ -16,7 +16,7 @@ configure_file(AMDDeviceLibsConfig.cmake.in
   @ONLY)
 
 
-set(install_path_suffix "amdgcn/bitcode")
+set(install_path_suffix "${CMAKE_INSTALL_LIBDIR}/amdgcn/bitcode")
 
 # Generate the install-tree package.
 # We do not know the absolute path to the intall tree until we are installed,
-- 
2.51.0

