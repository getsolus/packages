# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : r2modman
version    : 3.2.13
release    : 4
source     :
    - https://github.com/ebkr/r2modmanPlus/archive/refs/tags/v3.2.13.tar.gz : 16b984fb23599022e91d2b549cddf0125d4197876141a837da9fd841209ee5dc
homepage   : https://github.com/ebkr/r2modmanPlus
license    : MIT
component  : games
networking : true
summary    : A simple and easy to use mod manager for games using Thunderstore
description: |
    r2modman is a mod manager with support for Risk of Rain 2, Dyson Sphere Program, Valheim, GTFO, and many other games. It features a clean user interface designed to make modding as simple as possible.
builddeps  :
    - nodejs
setup      : |
    sed -i "s/'AppImage', 'tar.gz', 'deb', 'rpm', 'pacman'/'dir'/g" quasar.config.ts
    corepack enable
    yarn install
build      : |
    yarn build-linux
install    : |
    export r2mmdir=/usr/share/r2modman

    # Install and link binary
    install -dm00755 $installdir/$r2mmdir
    cp -R %workdir%/dist/electron/Packaged/linux-unpacked/* $installdir/$r2mmdir/.
    install -dm00755 $installdir/usr/bin
    ln -s $r2mmdir/r2modman $installdir/usr/bin/r2modman

    # Install desktop file
    install -Dm00644 $pkgfiles/io.github.ebkr.r2modman.desktop -t $installdir/usr/share/applications

    # Install icons
    for s in 16x16 24x24 32x32 48x48 64x64 96x96 128x128 192x192 256x256; do
        install -Dm0644 src/assets/icon/${s}.png $installdir/usr/share/icons/hicolor/${s}/apps/r2modman.png
    done

    # Install appstream metadata
    install -Dm00644 $pkgfiles/io.github.ebkr.r2modman.metainfo.xml -t $installdir/usr/share/metainfo
