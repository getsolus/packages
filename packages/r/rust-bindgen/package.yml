# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
# Don't update, causes Mesa build failures (https://gitlab.freedesktop.org/mesa/mesa/-/issues/11722#note_2576858)
name: rust-bindgen
version: 0.72.1
release: 5
source:
    - https://github.com/rust-lang/rust-bindgen/archive/refs/tags/v0.72.1.tar.gz: 4ffb17061b2d71f19c5062d2e17e64107248f484f9775c0b7d30a16a8238dfd1
license: BSD-3-Clause
component: programming
networking: true
homepage: https://github.com/rust-lang/rust-bindgen
summary: Tool for generating Rust FFI bindings
description: |
    Automatically generates Rust FFI bindings to C (and some C++) libraries
builddeps:
    - rust
setup: |
    %cargo_fetch
    mkdir -p completions
build: |
    %cargo_build --all-targets

    ./target/release/bindgen --generate-shell-completions bash > "completions/bindgen"
    ./target/release/bindgen --generate-shell-completions fish > "completions/bindgen.fish"
    ./target/release/bindgen --generate-shell-completions zsh  > "completions/_bindgen"
install: |
    %cargo_install bindgen

    install -Dm664 "completions/bindgen" -t "$installdir/usr/share/bash-completion/completions/"
    install -Dm664 "completions/bindgen.fish" -t "$installdir/usr/share/fish/vendor_completions.d/"
    install -Dm664 "completions/_bindgen" -t "$installdir/usr/share/zsh/site-functions/"
