name       : blender
version    : 2.79a
release    : 28
source     :
    - https://download.blender.org/source/blender-2.79a.tar.gz : 8ccf5f624ef020c903e0a302bfc6cd367eccb778e36e112c74c0a5e9762d84d7
license    : GPL-2.0
component  : multimedia.graphics
summary    : A fully integrated 3D graphics creation suite
description: |
    A fully integrated 3D graphics creation suite
builddeps  :
    - pkgconfig(fftw3f)
    - pkgconfig(freetype2)
    - pkgconfig(glew)
    - pkgconfig(glu)
    - pkgconfig(libavcodec)
    - pkgconfig(libopenjp2)
    - pkgconfig(libpng)
    - pkgconfig(libtiff-4)
    - pkgconfig(libturbojpeg)
    - pkgconfig(openal)
    - pkgconfig(OpenColorIO)
    - pkgconfig(OpenEXR)
    - pkgconfig(python3)
    - pkgconfig(sdl2)
    - pkgconfig(sndfile)
    - pkgconfig(x11)
    - pkgconfig(xi)
    - jemalloc-devel
    - libboost-devel
    - llvm-devel
    - openimageio-devel
setup      : |
    %patch -p1 < $pkgfiles/0007-fix_OpenJPEG2_build.patch

    mkdir build && pushd build
    # Need python3.4 for blender, gotta get this updated (task4 ikey)
    # Lots of enabling to do here, system glew, bullet, openjpeg, gameengine, etc..
    # importantly: fix clang, get llvm working here.
    %cmake .. \
        -DPYTHON_LIBPATH=%libdir% \
        -DPYTHON_LIBRARY=python3.6m \
        -DPYTHON_INCLUDE_DIR=/usr/include/python3.6m \
        -DWITH_INSTALL_PORTABLE=OFF \
        -DWITH_PYTHON_INSTALL=OFF \
        -DWITH_SDL=ON \
        -DWITH_IMAGE_OPENJPEG=ON \
        -DWITH_SYSTEM_OPENJPEG=ON \
        -DWITH_OPENCOLORIO=ON \
        -DWITH_FFTW3=ON \
        -DWITH_X11_XINPUT=ON \
        -DWITH_SDL_DYNLOAD=ON \
        -DWITH_CODEC_FFMPEG=ON \
        -DWITH_CODEC_SNDFILE=ON \
        -DWITH_SYSTEM_GLEW=ON \
        -DWITH_LLVM=ON
build      : |
    %make -C build
install    : |
    %make_install -C build
