From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Evan Maddock <maddock.evan@vivaldi.net>
Date: Sat, 1 Nov 2025 10:56:39 -0400
Subject: [PATCH] Port to libpeas-2 and budgie-2.0 on non-wayland

Signed-off-by: Evan Maddock <maddock.evan@vivaldi.net>
---
 budgie-clockworks/budgie_clockworks.py                   | 2 +-
 budgie-countdown/budgie-countdown.py                     | 2 +-
 budgie-dropby/budgie_dropby.py                           | 2 +-
 budgie-hotcorners/applet/src/meson.build                 | 4 ++--
 budgie-kangaroo/budgie_kangaroo.py                       | 2 +-
 budgie-keyboard-autoswitch/budgie-keyboard-autoswitch.py | 2 +-
 budgie-rotation-lock/budgie_rotation_lock.py             | 2 +-
 budgie-showtime/src/showtime/meson.build                 | 2 +-
 budgie-takeabreak/budgie_takeabreak.py                   | 2 +-
 budgie-trash/meson.build                                 | 2 +-
 budgie-visualspace/src/meson.build                       | 4 ++--
 budgie-window-shuffler/applet/src/meson.build            | 4 ++--
 budgie-workspace-stopwatch/budgie-workspacestopwatch.py  | 2 +-
 budgie-wswitcher/src/wswitcher/meson.build               | 2 +-
 meson.build                                              | 6 +++---
 15 files changed, 20 insertions(+), 20 deletions(-)

diff --git a/budgie-clockworks/budgie_clockworks.py b/budgie-clockworks/budgie_clockworks.py
index 3d0d063..82eeddb 100644
--- a/budgie-clockworks/budgie_clockworks.py
+++ b/budgie-clockworks/budgie_clockworks.py
@@ -6,7 +6,7 @@ from gi.repository import Libxfce4windowing
 if Libxfce4windowing.windowing_get() == Libxfce4windowing.Windowing.WAYLAND:
     gi.require_version('Budgie', '2.0')
 else:
-    gi.require_version('Budgie', '1.0')
+    gi.require_version('Budgie', '2.0')
 from gi.repository import Gdk, Gtk, GObject, GdkPixbuf, Budgie, Gio, GLib
 import os
 import time
diff --git a/budgie-countdown/budgie-countdown.py b/budgie-countdown/budgie-countdown.py
index 5544120..b939735 100644
--- a/budgie-countdown/budgie-countdown.py
+++ b/budgie-countdown/budgie-countdown.py
@@ -23,7 +23,7 @@ from gi.repository import Libxfce4windowing
 if Libxfce4windowing.windowing_get() == Libxfce4windowing.Windowing.WAYLAND:
     gi.require_version('Budgie', '2.0')
 else:
-    gi.require_version('Budgie', '1.0')
+    gi.require_version('Budgie', '2.0')
 gi.require_version('Gtk', '3.0')
 from gi.repository import Budgie, GObject, GdkPixbuf, Gtk, Gio, GLib
 from threading import Thread
diff --git a/budgie-dropby/budgie_dropby.py b/budgie-dropby/budgie_dropby.py
index ca6e23e..25d5bea 100644
--- a/budgie-dropby/budgie_dropby.py
+++ b/budgie-dropby/budgie_dropby.py
@@ -2,7 +2,7 @@
 import gi
 gi.require_version("Gtk", "3.0")
 gi.require_version("Wnck", "3.0")
-gi.require_version('Budgie', '1.0')
+gi.require_version('Budgie', '2.0')
 from gi.repository import Budgie, GObject, Gtk, Gio, Wnck, GLib
 import os
 import dropby_tools as db
diff --git a/budgie-hotcorners/applet/src/meson.build b/budgie-hotcorners/applet/src/meson.build
index 40d75c8..3abe9cd 100755
--- a/budgie-hotcorners/applet/src/meson.build
+++ b/budgie-hotcorners/applet/src/meson.build
@@ -14,11 +14,11 @@ HotCornersSources = [
 
 HotCornersDependencies = [
 dependency('gtk+-3.0'),
-dependency('budgie-1.0'),
+dependency('budgie-2.0'),
 dependency('json-glib-1.0'),
 dependency('gio-2.0'),
 dependency('gdk-3.0'),
-dependency('libpeas-gtk-1.0'),
+dependency('libpeas-2'),
 dependency('libnotify'),
 meson.get_compiler('c').find_library('m', required: false)
 ]
diff --git a/budgie-kangaroo/budgie_kangaroo.py b/budgie-kangaroo/budgie_kangaroo.py
index dcdb389..5af178f 100644
--- a/budgie-kangaroo/budgie_kangaroo.py
+++ b/budgie-kangaroo/budgie_kangaroo.py
@@ -7,7 +7,7 @@ from gi.repository import Libxfce4windowing
 if Libxfce4windowing.windowing_get() == Libxfce4windowing.Windowing.WAYLAND:
     gi.require_version('Budgie', '2.0')
 else:
-    gi.require_version('Budgie', '1.0')
+    gi.require_version('Budgie', '2.0')
 from gi.repository import Budgie, GObject, Gtk
 
 
diff --git a/budgie-keyboard-autoswitch/budgie-keyboard-autoswitch.py b/budgie-keyboard-autoswitch/budgie-keyboard-autoswitch.py
index 4889bdf..29e56be 100644
--- a/budgie-keyboard-autoswitch/budgie-keyboard-autoswitch.py
+++ b/budgie-keyboard-autoswitch/budgie-keyboard-autoswitch.py
@@ -18,7 +18,7 @@ program.  If not, see <http://www.gnu.org/licenses/>.
 
 import os
 import gi
-gi.require_version('Budgie', '1.0')
+gi.require_version('Budgie', '2.0')
 gi.require_version('Gtk', '3.0')
 from gi.repository import Budgie, GObject, Gtk, Gio, GLib
 from threading import Thread
diff --git a/budgie-rotation-lock/budgie_rotation_lock.py b/budgie-rotation-lock/budgie_rotation_lock.py
index 93ee632..264f445 100644
--- a/budgie-rotation-lock/budgie_rotation_lock.py
+++ b/budgie-rotation-lock/budgie_rotation_lock.py
@@ -1,6 +1,6 @@
 import gi.repository
 
-gi.require_version('Budgie', '1.0')
+gi.require_version('Budgie', '2.0')
 from gi.repository import Budgie, GObject, Gtk, Gio
 import os
 
diff --git a/budgie-showtime/src/showtime/meson.build b/budgie-showtime/src/showtime/meson.build
index 5c748ee..cee6838 100644
--- a/budgie-showtime/src/showtime/meson.build
+++ b/budgie-showtime/src/showtime/meson.build
@@ -12,7 +12,7 @@ BudgieShowTimeSources = [
 
 BudgieShowTimeDependencies = [
 dependency('gtk+-3.0'),
-dependency('budgie-1.0'),
+dependency('budgie-2.0'),
 dependency('gio-2.0'),
 dependency('gdk-3.0'),
 dependency('libwnck-3.0'),
diff --git a/budgie-takeabreak/budgie_takeabreak.py b/budgie-takeabreak/budgie_takeabreak.py
index ccfb6c0..f5ea70d 100644
--- a/budgie-takeabreak/budgie_takeabreak.py
+++ b/budgie-takeabreak/budgie_takeabreak.py
@@ -8,7 +8,7 @@ if Libxfce4windowing.windowing_get() == Libxfce4windowing.Windowing.WAYLAND:
     gi.require_version('Budgie', '2.0')
     wayland = True
 else:
-    gi.require_version('Budgie', '1.0')
+    gi.require_version('Budgie', '2.0')
     wayland = False
 from gi.repository import Budgie, GObject, Gtk, Gio, GLib
 import os
diff --git a/budgie-trash/meson.build b/budgie-trash/meson.build
index a595d5c..61a52f7 100644
--- a/budgie-trash/meson.build
+++ b/budgie-trash/meson.build
@@ -1,6 +1,6 @@
 
 # Dependencies
-dep_budgie = dependency('budgie-1.0', version: '>= 2')
+dep_budgie = dependency('budgie-2.0', version: '>= 2')
 dep_gtk3 = dependency('gtk+-3.0', version: '>= 3.22.0')
 dep_glib = dependency('glib-2.0', version: '>= 2.46.0')
 
diff --git a/budgie-visualspace/src/meson.build b/budgie-visualspace/src/meson.build
index 2bd34d3..41fac96 100644
--- a/budgie-visualspace/src/meson.build
+++ b/budgie-visualspace/src/meson.build
@@ -13,10 +13,10 @@ VisualSpaceSources = [
 
 VisualSpaceDependencies = [
 dependency('gtk+-3.0'),
-dependency('budgie-1.0'),
+dependency('budgie-2.0'),
 dependency('gdk-x11-3.0'),
 dependency('libwnck-3.0'),
-dependency('libpeas-gtk-1.0')
+dependency('libpeas-2')
 ]
 
 VisualSpaceArgs = [
diff --git a/budgie-window-shuffler/applet/src/meson.build b/budgie-window-shuffler/applet/src/meson.build
index 7549adb..07e51fd 100644
--- a/budgie-window-shuffler/applet/src/meson.build
+++ b/budgie-window-shuffler/applet/src/meson.build
@@ -12,8 +12,8 @@ ShufflerAppletSources = [
 ShufflerAppletDependencies = [
     dependency('gtk+-3.0'),
     dependency('gdk-3.0'),
-    dependency('budgie-1.0'),
-    dependency('libpeas-gtk-1.0'),
+    dependency('budgie-2.0'),
+    dependency('libpeas-2'),
     dependency('libnotify'),
     dependency('libwnck-3.0'),
     meson.get_compiler('c').find_library('m', required: false)
diff --git a/budgie-workspace-stopwatch/budgie-workspacestopwatch.py b/budgie-workspace-stopwatch/budgie-workspacestopwatch.py
index fb90ac0..4cfd6e5 100644
--- a/budgie-workspace-stopwatch/budgie-workspacestopwatch.py
+++ b/budgie-workspace-stopwatch/budgie-workspacestopwatch.py
@@ -1,7 +1,7 @@
 #! /usr/bin/python3
 import os
 import gi
-gi.require_version('Budgie', '1.0')
+gi.require_version('Budgie', '2.0')
 gi.require_version('Wnck', '3.0')
 gi.require_version('Gtk', '3.0')
 from gi.repository import Budgie, GObject, Gtk, Wnck, Gio, GLib
diff --git a/budgie-wswitcher/src/wswitcher/meson.build b/budgie-wswitcher/src/wswitcher/meson.build
index c0488d6..b3ad223 100644
--- a/budgie-wswitcher/src/wswitcher/meson.build
+++ b/budgie-wswitcher/src/wswitcher/meson.build
@@ -12,7 +12,7 @@ BudgieWSwitcherSources = [
 
 BudgieWSwitcherDependencies = [
 dependency('gtk+-3.0'),
-dependency('budgie-1.0'),
+dependency('budgie-2.0'),
 meson.get_compiler('c').find_library('m', required: false)
 ]
 
diff --git a/meson.build b/meson.build
index 316f5ff..c151396 100644
--- a/meson.build
+++ b/meson.build
@@ -72,9 +72,9 @@ conf.set_quoted('PACKAGE_SHAREDIR', datadir)
 for_wayland = get_option('for-wayland')
 
 if for_wayland == false
-	budgie_dep = dependency('budgie-1.0')
-	peas_dep = dependency('libpeas-1.0')
-	python_loader = 'python3'
+	budgie_dep = dependency('budgie-2.0')
+	peas_dep = dependency('libpeas-2')
+	python_loader = 'python'
 else
 	budgie_dep = dependency('budgie-2.0')
 	peas_dep = dependency('libpeas-2')
