name       : mailspring
version    : 1.10.2
release    : 40
source     :
    - https://github.com/Foundry376/Mailspring/releases/download/1.10.2/mailspring-1.10.2-amd64.deb : e8a1e19261d6863fc0804098a8db89d2248f118cae04369cff77d6e89d1f8138
homepage   : https://getmailspring.com/
license    :
    - GPL-3.0-or-later
    - Distributable # mailsync
component  : network.mail
summary    : A beautiful, fast and maintained fork of Nylas Mail by one of the original authors
description: |
    Leaving Nylas Mail? Mailspring is a new version by one of the original authors. It's faster, leaner, and shipping today! Mailspring replaces the JavaScript mailsync code in Nylas Mail with a new C++ sync engine based on Mailcore2. It uses roughly half the RAM and CPU of Nylas Mail and idles with almost zero "CPU Wakes", which translates to great battery life. A major overhaul of the package manager and dependency tree mean it launches faster too. You might not even notice it's an Electron app!
replaces   : n1
builddeps  :
    - pkgconfig(alsa)
    - pkgconfig(gbm)
    - pkgconfig(gtk+-3.0)
    - pkgconfig(libsecret-1)
    - pkgconfig(xkbfile)
    - pkgconfig(xshmfence)
    - cups-devel
rundeps    :
    - gnome-keyring # is required at least until kwallet can handle libsecret.
    - libglvnd
setup      : |
    ar x $sources/mailspring-${version}-amd64.deb
    tar xf data.tar.*
install    : |
    install -dm00644 $installdir
    cp -r usr $installdir

    # Link to System Libraries
    rm $installdir/usr/share/mailspring/libEGL.so
    rm $installdir/usr/share/mailspring/libGLESv2.so
    ln -s /usr/lib64/libEGL.so $installdir/usr/share/mailspring/libEGL.so
    ln -s /usr/lib64/libGLESv2.so $installdir/usr/share/mailspring/libGLESv2.so

    # Remove the doc dir which contains the Copyright file as duplicate
    rm -rf $installdir/usr/share/doc

    # Update appdata location to metainfo
    mv $installdir/usr/share/appdata $installdir/usr/share/metainfo/

