# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : glslang
version    : 16.2.0
release    : 36
source     :
    - https://github.com/KhronosGroup/glslang/archive/refs/tags/vulkan-sdk-1.4.341.0.tar.gz : 18cdf7d40a39001dde842c6a1338b2c9321ac5e487139b9d52b4b9c666da3c86
license    : BSD-3-Clause
component  : xorg.display
homepage   : https://github.com/KhronosGroup/glslang
summary    : Khronos reference front-end for GLSL and ESSL, and sample SPIR-V generator
description: |
    Khronos reference front-end for GLSL and ESSL, and sample SPIR-V generator
patterns   :
    - 32bit-devel : /usr/lib32/cmake
emul32     : true
builddeps  :
    - pkgconfig32(SPIRV-Tools)
rundeps    :
    - 32bit-devel :
        - spirv-tools-32bit-devel
    - devel :
        - spirv-tools-devel
# We can't enable LTO on this object until we have a way to disable stripping static libs only, otherwise the shaderc build will fail
# optimize   :
#     - lto
clang      : true
environment: |
    export CXXFLAGS="$CXXFLAGS -ffat-lto-objects"
setup      : |
    %cmake_ninja \
        -DCMAKE_INSTALL_LIBDIR=%libdir% \
        -DBUILD_SHARED_LIBS=ON \
        -DALLOW_EXTERNAL_SPIRV_TOOLS=ON \
        -DGLSLANG_TESTS=ON
build      : |
    %ninja_build
install    : |
    %ninja_install
    %install_license LICENSE.txt
check      : |
    %ninja_check
