# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name: gopass
version: 1.16.0
release: 42
source:
    - https://github.com/gopasspw/gopass/archive/refs/tags/v1.16.0.tar.gz#gopass.tar.gz: c7e6c5688c19765a740b9617eb4034c85645a80aa9c693d713869071d5c023a9
    - https://github.com/gopasspw/git-credential-gopass/archive/refs/tags/v1.16.0.tar.gz#git-credential-gopass.tar.gz: de034059597d4853da5e55e793c1577a779dfc64ef5d7cffaad10808a6442d1d
    - https://github.com/gopasspw/gopass-hibp/archive/refs/tags/v1.16.0.tar.gz#gopass-hibp.tar.gz: eedc95494f40a2c0be6b68229e2a73c319e5c378c1ea5af2d3c1b9bc68530a5f
    - https://github.com/gopasspw/gopass-jsonapi/archive/refs/tags/v1.16.0.tar.gz#gopass-jsonapi.tar.gz: a81c64a44278b30026e42b6289678c1a4765dea8a97753cc33c09f0b7dd24aca
    - https://github.com/gopasspw/gopass-summon-provider/archive/refs/tags/v1.16.0.tar.gz#gopass-summon-provider.tar.gz: 9cb72fae0056688520647df07b64ba271127a7d93bb544e87be63ee9140bccd9
homepage: https://www.gopass.pw
license: MIT
component: security
networking: true
summary: The slightly more awesome standard unix password manager for teams
description: |
    gopass is a rewrite of the pass password manager in Go with the aim of making it cross-platform and adding additional features.
builddeps:
    - golang
rundeps:
    - git
    - gnupg
    - xdotool
    - xsel
setup: |
    mkdir -p integrations
    for i in git-credential-gopass gopass-{hibp,jsonapi,summon-provider}; do
        tar -x -C integrations -f $sources/$i.tar.gz
    done
build: |
    %make
    for i in integrations/*; do
        pushd $i; go mod tidy; popd
        %make -C $i
    done
install: |
    %make_install PREFIX=/usr
    for i in integrations/*; do
        %make_install -C $i PREFIX=/usr
    done

    # Set correct permission bits for the shell completion files
    chmod 644 $installdir/usr/share/zsh/site-functions/_gopass
    chmod 644 $installdir/usr/share/bash-completion/completions/gopass
    chmod 644 $installdir/usr/share/fish/vendor_completions.d/gopass.fish
