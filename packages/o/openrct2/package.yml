# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : openrct2
version    : 0.4.29
release    : 62
source     :
    - git|https://github.com/OpenRCT2/OpenRCT2.git : v0.4.29
    - https://github.com/OpenRCT2/title-sequences/releases/download/v0.4.26/title-sequences.zip : dabb9787b1576342fca4dd9f64b3f8cfa04a7e6ce9c2bb9610f47b762905c858
    - https://github.com/OpenRCT2/objects/releases/download/v1.7.5/objects.zip : c8b9d3039a920f67caf15b09e8312cc4f80d59ed7fe0288625b9ccedef606797
    - https://github.com/OpenRCT2/OpenSoundEffects/releases/download/v1.0.6/opensound.zip : 06b90f3e19c216752df441d551b26a9e3e1ba7755bdd2102504b73bf993608be
    - https://github.com/OpenRCT2/OpenMusic/releases/download/v1.6.1/openmusic.zip : 994b350d3b180ee1cb9619fe27f7ebae3a1a5232840c4bd47a89f33fa89de1a1
license    :
    - CC-BY-4.0
    - CC-BY-SA-4.0
    - GPL-3.0-or-later
    - MIT
component  : games.strategy
homepage   : https://openrct2.io/
summary    : A construction and management simulation video game that simulates amusement park management
description: |
    OpenRCT2 is an open-source re-implementation of RollerCoaster Tycoon 2 (RCT2). The gameplay revolves around building and maintaining an amusement park containing attractions, shops and facilities. The player must try to make a profit and maintain a good park reputation whilst keeping the guests happy. OpenRCT2 allows for both scenario and sandbox play. Scenarios require the player to complete a certain objective in a set time limit whilst sandbox allows the player to build a more flexible park with optionally no restrictions or finance. Original RollerCoaster Tycoon 2 game files are required in order to play OpenRCT2.
clang      : true
builddeps  :
    - pkgconfig(flac)
    - pkgconfig(fontconfig)
    - pkgconfig(gl)
    - pkgconfig(libcurl)
    - pkgconfig(libzip)
    - pkgconfig(nlohmann_json)
    - pkgconfig(sdl2)
    - pkgconfig(speexdsp)
    - pkgconfig(vorbisfile)
rundeps    :
    - innoextract
environment: |
    # Check if fixed for 4.24 https://github.com/OpenRCT2/OpenRCT2/issues/24239
    export CXXFLAGS="${CFLAGS} -Wno-error=null-dereference"
setup      : |
    %cmake_ninja \
        -DDOWNLOAD_OBJECTS=OFF \
        -DDOWNLOAD_OPENMSX=OFF \
        -DDOWNLOAD_OPENSFX=OFF \
        -DDOWNLOAD_TITLE_SEQUENCES=OFF \
        -DSTATIC=OFF
build      : |
    %ninja_build
install    : |
    export DATADIR=$workdir/data/
    install -Ddm00644 $DATADIR/sequence/
    unzip $sources/title-sequences.zip -d $DATADIR/sequence/
    install -Ddm00644 $DATADIR/object/
    unzip $sources/objects.zip -d $DATADIR/object/
    unzip $sources/opensound.zip -d $DATADIR
    unzip $sources/openmusic.zip -d $DATADIR

    %ninja_install

    # Nuke useless -devel
    rm -v $installdir/%libdir%/*.a
    rmdir $installdir/%libdir%
    # Nuke unneeded docs
    rm -v $installdir/usr/share/doc/openrct2/contributors.md
    rm -v $installdir/usr/share/doc/openrct2/licence.txt
    rm -v $installdir/usr/share/doc/openrct2/openrct2.d.ts
