From c58152d94ba878b2d7d76bcac59146312199b9eb Mon Sep 17 00:00:00 2001
From: blendin <btiszka@gmail.com>
Date: Tue, 26 Sep 2017 23:04:01 -0700
Subject: [PATCH] Fix out of bounds write

---
 modules/imgcodecs/src/grfmt_bmp.cpp | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/modules/imgcodecs/src/grfmt_bmp.cpp b/modules/imgcodecs/src/grfmt_bmp.cpp
index 3c7edf0f981..45e02ceae6f 100644
--- a/modules/imgcodecs/src/grfmt_bmp.cpp
+++ b/modules/imgcodecs/src/grfmt_bmp.cpp
@@ -375,6 +375,9 @@ decode_rle4_bad: ;
                                                 gray_palette[code] );
 
                         line_end_flag = y - prev_y;
+
+                        if( y >= m_height )
+                            break;
                     }
                     else if( code > 2 ) // absolute mode
                     {

