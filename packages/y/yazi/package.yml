# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : yazi
version    : 26.1.22
release    : 7
source     :
    - https://github.com/sxyazi/yazi/archive/refs/tags/v26.1.22.tar.gz : 83b8a1bf166bfcb54b44b966fa3f34afa7c55584bf81d29275a1cdd99d1c9c4c
homepage   : https://yazi-rs.github.io
license    : MIT
component  : system.utils
summary    : Blazingly fast terminal file manager
description: |
    Yazi is a terminal file manager written in Rust with async I/O, rich preview,
    and extensibility through plugins and themes.
networking : true
builddeps  :
    - rust
rundeps    :
    - file
setup      : |
    # Fix desktop to avoid duplicate entries
    sed -i 's/Categories=.*/Categories=System;FileManager;/' "assets/yazi.desktop"
    %cargo_fetch
build      : |
    export YAZI_GEN_COMPLETIONS=true
    %cargo_build
install    : |
    %cargo_install yazi ya
    %install_license LICENSE*
    install -Dm00644 "assets/yazi.desktop" "$installdir/usr/share/applications/yazi.desktop"

    # Install appstream metainfo
    install -Dm00644 "$pkgfiles/io.github.sxyazi.yazi.metainfo.xml" "$installdir/usr/share/metainfo/io.github.sxyazi.yazi.metainfo.xml"

    # Install icon
    install -Dm00644 "assets/logo.png" "$installdir/usr/share/icons/hicolor/512x512/apps/yazi.png"

    # Install shell completions for yazi
    install -Dm00644 "yazi-boot/completions/yazi.bash" "$installdir/usr/share/bash-completion/completions/yazi"
    install -Dm00644 "yazi-boot/completions/yazi.fish" "$installdir/usr/share/fish/vendor_completions.d/yazi.fish"
    install -Dm00644 "yazi-boot/completions/_yazi" "$installdir/usr/share/zsh/site-functions/_yazi"

    # Install shell completions for ya
    install -Dm00644 "yazi-cli/completions/ya.bash" "$installdir/usr/share/bash-completion/completions/ya"
    install -Dm00644 "yazi-cli/completions/ya.fish" "$installdir/usr/share/fish/vendor_completions.d/ya.fish"
    install -Dm00644 "yazi-cli/completions/_ya" "$installdir/usr/share/zsh/site-functions/_ya"
