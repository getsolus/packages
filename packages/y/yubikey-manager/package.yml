name       : yubikey-manager
version    : 5.8.0
release    : 46
source     :
    - https://github.com/Yubico/yubikey-manager/releases/download/5.8.0/yubikey_manager-5.8.0.tar.gz : 3af0da65e1fdd46763c94ee74e2da55a4b6e7771da776c197f5f4b4581738560
homepage   : https://developers.yubico.com/yubikey-manager/
license    : BSD-2-Clause
component  : security
summary    : Command line utility for configuring your YubiKey
description: |
    Python library and command line tool for configuring any YubiKey over all USB transports.
networking : true
builddeps  :
    - pkgconfig(python3)
    - pcsc-lite
    - python-build
    - python-fido2
    - python-installer
    - python-poetry
    - python-pyscard
rundeps    :
    - ccid
    - python-click
    - python-cryptography
    - python-fido2
    - python-keyring
    - python-openssl
    - python-pyscard
build      : |
    %python3_setup
    gzip man/ykman.1

    # Create shell completions
    python -m venv --system-site-packages completion-env
    completion-env/bin/python -m installer dist/*.whl
    _YKMAN_COMPLETE=bash_source completion-env/bin/ykman > ykman.bash
    _YKMAN_COMPLETE=zsh_source completion-env/bin/ykman > _ykman
install    : |
    %python3_install
    # Vendor enable pcscd.socket so this works OOTB.
    install -dm00755 $installdir/%libdir%/systemd/system/sockets.target.wants
    ln -sv ../pcscd.socket $installdir/%libdir%/systemd/system/sockets.target.wants/pcscd.socket

    # Manpages
    install -Dm00644 man/ykman.1.gz $installdir/usr/share/man/man1/ykman.1.gz

    # Install completions
    install -Dm0644 ykman.bash -t "$installdir/usr/share/bash-completion/completions/"
    install -Dm0644 _ykman -t "$installdir/usr/share/zsh/site-functions/"

    # Include copyright notice as required by the license
    install -Dm0644 -t "$installdir/usr/share/licenses/$package/" COPYING 
