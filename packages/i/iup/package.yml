name       : iup
version    : 3.31
release    : 1
source     :
    - https://sourceforge.net/projects/iup/files/3.31/Docs%20and%20Sources/iup-3.31_Sources.zip : baceb6b74dd72fac5f7e8100ba469fd9e47d8a26e9c5569cf63200ab2268f1c7
homepage   : https://iup.sourceforge.net/
license    : MIT
component  : multimedia.graphics
summary    : A multi-platform toolkit for building graphical user interfaces
description: |
    IUP is a multi-platform toolkit for building graphical user interfaces. It offers a simple API in three basic languages: C, Lua and LED. IUP's purpose is to allow a program source code to be compiled in different systems without any modification.
builddeps  :
    - pkgconfig(ftgl)
    - pkgconfig(glu)
    - pkgconfig(libcd)
    - pkgconfig(libcd-lua)
    - pkgconfig(libim)
    - pkgconfig(libim-lua)
    - pkgconfig(lua)
    - pkgconfig(webkit2gtk-4.0)
    - lsb-release
rundeps:
    - lua-devel:
        - iup-lua
patterns   :
    - lua :
        - /usr/bin/iuplua*
        - /usr/lib64/libiuplua*.so.*
        - /usr/share/applications/iuplua*
        - /usr/share/icons/iuplua*
    - lua-devel :
        - /usr/include/tecgraf/iup/iuplua*.h
        - /usr/lib64/libiuplua*.so
        - /usr/lib64/pkgconfig/*lua.pc
environment:
    export USE_PKGCONFIG=Yes
    export USE_LUA_VERSION=53
    export LIBLUA_SFX=
    export LUA_SFX=
    export LUA_INC=/usr/include
    export LUA_LIB=/usr/lib
    export LUA_BIN=/usr/bin/lua
    export IM_LIB=/usr/lib
    export IM_INC=/usr/include/tecgraf/im
    export CD_LIB=/usr/lib
    export CD_INC=/usr/include/tecgraf/cd
    export FTGL_LIB=/usr/lib
    export FTGL_INC=/usr/include
setup      : |
    %patch -p 1 -i $pkgfiles/0001-Disabling-static-linux6-support.patch
    %patch -p 1 -i $pkgfiles/0002-fix-lua-sfx.patch
    %patch -p 1 -i $pkgfiles/0003-shared-links.patch
build      : |
    %make -j1
install    : |
    install -dm00755 $installdir/usr/{bin,lib64/pkgconfig,include/tecgraf/iup,share/{icons,applications}}
    install -m00644 $pkgfiles/*.pc $installdir/usr/lib64/pkgconfig
    rm lib/Linux*/{*.a,Lua/*.a}
    chmod -R 00755 lib/Linux*/*
    mv lib/Linux*/*.* $installdir/usr/lib64/
    mv lib/Linux*/Lua/*.* $installdir/usr/lib64/
    install -m00644 include/* $installdir/usr/include/tecgraf/iup/
    install -m00755 bin/Linux*/{iupview,iupvled,ledc} $installdir/usr/bin
    install -m00755 bin/Linux*/Lua/{iuplua,iupluascripter} $installdir/usr/bin
    install -m00644 $pkgfiles/*.desktop $installdir/usr/share/applications
    install -m00644 $pkgfiles/tecgraf-logo.png $installdir/usr/share/icons/iup.png
    install -m00644 $pkgfiles/tecgraf-logo.png $installdir/usr/share/icons/iuplua.png
