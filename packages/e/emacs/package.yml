# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : emacs
version    : '30.2'
release    : 41
source     :
    - https://ftpmirror.gnu.org/gnu/emacs/emacs-30.2.tar.xz : b3f36f18a6dd2715713370166257de2fae01f9d38cfe878ced9b1e6ded5befd9
license    : GPL-3.0-or-later
homepage   : https://www.gnu.org/software/emacs/
component  : editor
summary    : An extensible, customizable text editor-and more
description: |
    GNU Emacs is an extensible, customizable text editor-and more. At its core is an interpreter for Emacs Lisp, a dialect of the Lisp programming language with extensions to support text editing. It has many features to increase productivity when programming.
builddeps  :
    - pkgconfig(cairo)
    - pkgconfig(gconf-2.0)
    - pkgconfig(gnutls)
    - pkgconfig(gtk+-3.0)
    - pkgconfig(harfbuzz)
    - pkgconfig(lcms2)
    - pkgconfig(libacl)
    - pkgconfig(libpng)
    - pkgconfig(librsvg-2.0)
    - pkgconfig(libtiff-4)
    - pkgconfig(libturbojpeg)
    - pkgconfig(libwebp)
    - pkgconfig(libxml-2.0)
    - pkgconfig(pango)
    - pkgconfig(sqlite3)
    - pkgconfig(tree-sitter)
    - pkgconfig(xaw3d)
    - pkgconfig(xpm)
    - giflib-devel
    - gpm-devel
    - libgccjit-devel
    - xorgproto
optimize   : speed
setup      : |
    %configure \
    --disable-build-details \
    --enable-acl \
    --enable-link-time-optimization \
    --program-transform-name='s/^ctags$/ctags.emacs/' \
    --with-cairo \
    --with-modules \
    --with-native-compilation=yes \
    --with-sound=no \
    --with-tree-sitter \
    --with-x-toolkit=gtk3 \
    --with-xinput2 \
    --with-xwidgets=no \
    --without-libotf \
    --without-m17n-flt
build      : |
    %make
install    : |
    %make_install
    %install_license COPYING

    # Fix permissions being set to the build user
    chown -R root:root "${installdir}/usr/share/emacs"
