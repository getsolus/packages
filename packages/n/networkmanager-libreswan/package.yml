# yaml-language-server: $schema=/usr/share/ypkg/schema/schema.json
name       : networkmanager-libreswan
version    : 1.2.30
release    : 20
source     :
    - https://download.gnome.org/sources/NetworkManager-libreswan/1.2/NetworkManager-libreswan-1.2.30.tar.xz : 6670af36d3bb4887e528f803babb689e42711e4ebbd29d8df6a178d3f17a11d3
homepage   : https://networkmanager.dev
license    : GPL-2.0-or-later
component  : network.base
summary    : Libreswan VPN client plugin for NetworkManager
description: |
    Libreswan VPN client plugin for NetworkManager
builddeps  :
    - pkgconfig(gtk+-3.0)
    - pkgconfig(gtk4)
    - pkgconfig(libnl-3.0)
    - pkgconfig(libnma)
    - pkgconfig(libsecret-unstable)
rundeps    :
    - libreswan
conflicts  :
    - networkmanager-strongswan
setup      : |
    # Only dbus-1 goes into sysconfdir (etc by default) so move it
    %configure --with-gtk4
build      : |
    %make
install    : |
    %make_install
    %install_license COPYING

    install -dm00755 $installdir/usr/share/dbus-1/system.d
    mv $installdir/etc/dbus-1/system.d/nm-libreswan-service.conf $installdir/usr/share/dbus-1/system.d

    rmdir -v $installdir/etc/dbus-1/system.d \
             $installdir/etc/dbus-1 \
             $installdir/etc
