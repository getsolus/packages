---
name: Script Lint
on:
  pull_request:
    paths:
      - 'common/**'
concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true
jobs:
  Python:
    name: Python Linting
    runs-on: ubuntu-latest
    steps:
      - name: Check out source repository
        uses: actions/checkout@v4
      - name: Set up Python environment
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"
      - name: flake8 Lint
        uses: py-actions/flake8@v2
        with:
           path: common/CI common/Hooks common/Scripts/worklog.py
      - name: mypy lint
        uses: jpetrucciani/mypy-check@master
        with:
          path: common/CI common/Hooks common/Scripts/worklog.py
          python_version: "3.10"
          requirements: types-PyYAML
  ShellCheck:
    name: ShellCheck
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run ShellCheck
        uses: ludeeus/action-shellcheck@master
        with:
          scandir: common
          check_together: 'yes'
          ignore_paths: >-
            common/Legacy/**
            common/Scripts/package-publish-safety-catches.sh
            common/Scripts/helpers.zsh
            common/Scripts/sync_licenses.sh
            common/Scripts/new-package.sh
            common/Scripts/find-old.sh
            common/Scripts/rebuild-template-script.sh
            common/Scripts/buildserver-notification.sh
            common/Scripts/update_stateless.sh
